<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inputs &amp; Outputs • SimBu</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Inputs &amp; Outputs">
<meta property="og:description" content="SimBu">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SimBu</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simulator_documentation.html">Getting started with the pseudo-bulk simulator R package</a>
    </li>
    <li>
      <a href="../articles/simulator_input_output.html">Inputs &amp; Outputs</a>
    </li>
    <li>
      <a href="../articles/simulator_scaling_factors.html">Introducing mRNA bias into simulations with scaling factors</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="simulator_input_output_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Inputs &amp; Outputs</h1>
                        <h4 class="author">Alexander Dietrich</h4>
            
      
      
      <div class="hidden name"><code>simulator_input_output.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">SimBu</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat">Seurat</a></span><span class="op">)</span>
<span class="co">#&gt; Attaching SeuratObject</span></code></pre></div>
<p>This chapter covers the different input and output options of the package in detail.</p>
<div id="input" class="section level1">
<h1 class="hasAnchor">
<a href="#input" class="anchor"></a>Input</h1>
<p>The input for your simulations is always the custom <code>dataset</code> object. You can create this object with different constructing functions, which will explained below. It is also possible to merge multiple <code>dataset</code> objects into one.</p>
<div id="sfaira" class="section level2">
<h2 class="hasAnchor">
<a href="#sfaira" class="anchor"></a>Sfaira</h2>
<p>To use the public database sfaira, you first need to setup a connection to it. To do so, follow the steps in the “Getting started” vignette. You can now use the <code>dataset_sfaira_multiple</code> or <code>dataset_sfaira</code> to create a <code>dataset</code> object like this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ds_human_pancreas</span> <span class="op">&lt;-</span> <span class="fu">SimBu</span><span class="fu">::</span><span class="fu"><a href="../reference/dataset_sfaira_multiple.html">dataset_sfaira_multiple</a></span><span class="op">(</span>sfaira_setup <span class="op">=</span> <span class="va">setup_list</span>,
                                                    organisms <span class="op">=</span> <span class="st">"human"</span>, 
                                                    tissues <span class="op">=</span> <span class="st">"pancreas"</span>, 
                                                    name<span class="op">=</span><span class="st">"human_pancreas"</span><span class="op">)</span>

<span class="va">ds_miller</span> <span class="op">&lt;-</span> <span class="fu">SimBu</span><span class="fu">::</span><span class="fu"><a href="../reference/dataset_sfaira.html">dataset_sfaira</a></span><span class="op">(</span>sfaira_setup <span class="op">=</span> <span class="va">setup_list</span>,
                                   sfaira_id<span class="op">=</span><span class="st">"human_lung_2020_10x3v2_miller_001_10.1016/j.devcel.2020.01.033"</span>,
                                   name <span class="op">=</span> <span class="st">"Miller"</span><span class="op">)</span></code></pre></div>
<p>As you can see, <code>dataset_sfaira_multiple</code> allows to download multiple datasets of the same organism, tissue or assay; with <code>dataset_sfaira</code> you can access a single dataset directly. You can use the <code>sfaira_overview</code> function to find a table of all possible datasets as well as their IDs.</p>
</div>
<div id="custom-data" class="section level2">
<h2 class="hasAnchor">
<a href="#custom-data" class="anchor"></a>Custom data</h2>
<p>When building <code>dataset</code> objects with your own data, you need to provide a count matrix with the genes in rows and cells in columns. Additionally, an annotation table is needed, with the cell-type annotations. It needs to consist at least out of 2 columns: <code>ID</code> and <code>cell_type</code>, where <code>ID</code> has to be identical to the column names of the count matrix. If not all cells appear in the annotation or count matrix, the intersection of both is used to build the <code>dataset</code>.<br>
Additionally, the name of the dataset has to be given.<br>
The straight forward approach can be executed like this:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ds_basic</span> <span class="op">&lt;-</span> <span class="fu">SimBu</span><span class="fu">::</span><span class="fu"><a href="../reference/dataset.html">dataset</a></span><span class="op">(</span>count_matrix <span class="op">=</span> <span class="va">count_matrix</span>,
                           annotation <span class="op">=</span> <span class="va">annotaton</span>,
                           name <span class="op">=</span> <span class="st">"basic_dataset"</span><span class="op">)</span></code></pre></div>
<div id="seurat" class="section level3">
<h3 class="hasAnchor">
<a href="#seurat" class="anchor"></a>Seurat</h3>
<p>It is possible to use a Seurat object to build a <code>dataset</code>; you need an additional dataframe for the annotation:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ds_seurat</span> <span class="op">&lt;-</span> <span class="fu">SimBu</span><span class="fu">::</span><span class="fu"><a href="../reference/dataset_seurat.html">dataset_seurat</a></span><span class="op">(</span>seurat_obj <span class="op">=</span> <span class="va">seurat_object</span>,
                                   annotation <span class="op">=</span> <span class="va">annotation</span>,
                                   name <span class="op">=</span> <span class="st">"seurat_dataset"</span><span class="op">)</span></code></pre></div>
</div>
<div id="h5ad-files" class="section level3">
<h3 class="hasAnchor">
<a href="#h5ad-files" class="anchor"></a>h5ad files</h3>
<p>It is possible to use an h5ad file directly, a file format which stores <a href="https://anndata.readthedocs.io/en/latest/">AnnData</a> objects; again you need an additional dataframe for the annotation:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">ds_h5ad</span> <span class="op">&lt;-</span> <span class="fu">SimBu</span><span class="fu">::</span><span class="fu"><a href="../reference/dataset_h5ad.html">dataset_h5ad</a></span><span class="op">(</span>h5ad_file <span class="op">=</span> <span class="va">h5ad_file_path</span>,
                               annotation <span class="op">=</span> <span class="va">annotation</span>,
                               name <span class="op">=</span> <span class="st">"h5ad_dataset"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="merging-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#merging-datasets" class="anchor"></a>Merging datasets</h2>
<p>You are able to merge multiple datasets by using the <code>dataset_multiple</code> function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">ds_multiple</span> <span class="op">&lt;-</span> <span class="fu">SimBu</span><span class="fu">::</span><span class="fu"><a href="../reference/dataset_multiple.html">dataset_multiple</a></span><span class="op">(</span>dataset_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ds_1</span>, <span class="va">ds_2</span>, <span class="va">ds_3</span><span class="op">)</span>,
                                       name <span class="op">=</span> <span class="st">"ds_multiple"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="simulations" class="section level1">
<h1 class="hasAnchor">
<a href="#simulations" class="anchor"></a>Simulations</h1>
<p>Once the <code>dataset</code> is generated, you can use <code>simulate_bulk</code> to generate pseudo-bulk samples, resulting in an artificial RNA-seq dataset.<br>
Similar to datasets, it is also possible to merge simulations:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">merged_simulations</span> <span class="op">&lt;-</span> <span class="fu">SimBu</span><span class="fu">::</span><span class="fu"><a href="../reference/merge_simulations.html">merge_simulations</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">sim_1</span>, <span class="va">sim_2</span>, <span class="va">sim_3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="output" class="section level1">
<h1 class="hasAnchor">
<a href="#output" class="anchor"></a>Output</h1>
<p>The output of this function is a named list with 5 entries:</p>
<ul>
<li><p><code>pseudo_bulk</code>: a sparse matrix with genes in rows and the simulated samples in columns. By default TPM normalized.<br></p></li>
<li><p><code>pseudo_bulk_raw</code>: a sparse matrix, same dimensions as <code>pseudo_bulk</code>, but raw counts. Depending on the scaling factor method used, the distribution of these values can be shifted.<br></p></li>
<li><p><code>cell_fractions</code>: a table where rows represent the simulated samples and columns represent the different simulated cell-types. The entries in the table store the specific cell-type fraction per sample.<br></p></li>
<li><p><code>scaling_vector</code>: a named list, with the used scaling value for each cell from the single cell dataset.<br></p></li>
<li><p><code>expression_set</code>: a Biobase <a href="https://rdrr.io/bioc/Biobase/man/class.ExpressionSet.html">ExpressionSet</a>, containing annotation data as well as the TPM normalized expression matrix.<br></p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alexander Dietrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
